<!doctype html>
<html lang="el">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
<title>Store311 Attendance</title>
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#ffffff">
<style>
:root { --pad:22px; --blue:#3b82f6; --blue-border:#1d4ed8; --green:#d9fbe4; --green-border:#b8f0c8; }

/* Ίδιο ύψος iOS/Android */
html, body { height:-webkit-fill-available; }
html, body {
width:100%; margin:0; overflow:hidden; background:#fff; color:#111;
font-family:system-ui,-apple-system,Segoe UI,Roboto,'Helvetica Neue',Arial;
}

.viewport {
box-sizing:border-box;
height:100dvh; width:100vw;
padding:10px 20px 20px;
display:flex; flex-direction:column; gap:14px;
}

/* --- LOGO (όπως στο screenshot) --- */
.brand {
display:flex; flex-direction:column; align-items:center; gap:8px; margin-top:6px;
}
.brand img {
display:block;
width: clamp(120px, 18vw, 160px);
height:auto;
margin:6px auto 10px;
image-rendering:auto;
-webkit-user-drag:none;
}
.brand .title { font-weight:800; font-size:26px; }
.brand .subtitle { color:#444; margin-top:2px; }

.toprow{ display:flex; justify-content:flex-end; gap:10px; }
.lockbtn{ border:1px solid #d7dbe2; background:#fff; padding:8px 10px; border-radius:10px; cursor:pointer; font-size:14px; }

.tabbar{ display:flex; gap:14px; justify-content:center; flex-wrap:wrap; }
.tabbar button{ padding:10px 14px; border-radius:14px; border:1px solid #ddd; background:#f6f7fb; cursor:pointer; }
.tabbar button.active{ background:#dfe2e8; border-color:#cfd4dc; }
.tabbar .guard::after{ content:" 🔒"; font-size:12px; opacity:.7; }

.content{ flex:1; display:flex; flex-direction:column; gap:14px; overflow:hidden; }
.tab{ display:none; flex:1; overflow:auto; -webkit-overflow-scrolling:touch; }
.tab.active{ display:block; }

.card{ background:#fff; padding:14px; border-radius:12px; box-shadow:0 6px 18px rgba(0,0,0,.06); }

label{ display:block; margin:8px 0 6px; font-size:14px; color:#333; }
input,select,button,textarea{ font-size:16px; padding:12px; border-radius:10px; border:1px solid #d7dbe2; outline:none; }
textarea{ resize:vertical; }
.row{ display:flex; gap:10px; flex-wrap:wrap; }
.grow{ flex:1; }

.controls{ display:flex; gap:20px; flex-wrap:wrap; margin-top:10px; }
.bigbtn{ flex:1; min-height:112px; font-size:26px; font-weight:800; border-radius:20px; }
.in{ background:#d9fbe4; border:1px solid #b8f0c8; color:#14532d; }
.out{ background:#3b82f6; border:1px solid #1d4ed8; color:#fff; }
.in:active,.out:active{ filter:brightness(0.97); }
@media (max-width:520px){ .bigbtn{ flex-basis:100%; } }

table{ width:100%; border-collapse:collapse; margin-top:12px; font-size:14px; }
th,td{ padding:8px; border-bottom:1px solid #eee; text-align:left; }

.hint{ color:#666; font-size:13px; margin-top:6px; }
.status{ margin-top:8px; font-size:14px; }
footer{ color:#666; font-size:12px; text-align:center; padding:8px 0; }

/* Modal PIN */
#pinModal{ display:none; position:fixed; inset:0; background:rgba(0,0,0,.45); align-items:center; justify-content:center; }
#pinBox{ background:#fff; padding:18px; border-radius:12px; width:320px; box-shadow:0 10px 30px rgba(0,0,0,.2); }
#pinBox h3{ margin:0 0 8px 0; font-size:18px; }
#pinMsg{ color:#b42318; font-size:13px; margin-top:8px; }
</style>
</head>

<body>
<div class="viewport">
<div class="brand">
<img id="logo" src="logo.png?v=7" alt="Store311 logo">
<div class="title">Store311 Attendance</div>
<div class="subtitle">Σύστημα παρουσιών προσωπικού</div>
</div>

<div class="toprow">
<button class="lockbtn" id="lockBtn">Κλείδωμα</button>
</div>

<div class="tabbar">
<button class="tabbtn active" data-tab="punch">Χτύπημα</button>
<button class="tabbtn guard" data-tab="history">Ιστορικό</button>
<button class="tabbtn guard" data-tab="reports">Αναφορές</button>
<button class="tabbtn guard" data-tab="settings">Ρυθμίσεις</button>
</div>

<div class="content">
<div class="card tab active" id="tab-punch">
<div class="row">
<div class="grow">
<label>Επιλέξτε εργαζόμενο / Προσθήκη</label>
<div class="row">
<select id="employee" class="grow"></select>
<input id="newname" placeholder="Νέο όνομα">
<button id="add" class="small">Πρόσθεσε</button>
</div>
<div class="hint">Καταχώριση IN/OUT — αποθήκευση offline & αποστολή στο cloud (αν έχεις Webhook URL).</div>
</div>
<div>
<label for="note">Σημείωση</label>
<input id="note" placeholder="π.χ. καθυστέρηση ΜΜΜ">
</div>
</div>

<div style="margin-top:10px">
<label>Χτύπημα κάρτας</label>
<div class="controls">
<button id="punchIn" class="bigbtn in">✓ IN–Είσοδος</button>
<button id="punchOut" class="bigbtn out">◼︎ OUT — Αποχώρηση</button>
</div>
<div id="statusRow" class="status">—</div>
<div id="lastRow" class="hint">Τελευταίο χτύπημα: —</div>
</div>
</div>

<div class="card tab" id="tab-history">
<div class="row" style="justify-content:space-between;align-items:center">
<div class="grow"><label>Ιστορικό (πιο πρόσφατα πρώτα)</label></div>
<div class="row">
<input id="search" placeholder="αναζήτηση ονόματος/ημερομηνίας">
<button id="exportBtn" class="small">CSV</button>
<button id="downloadJson" class="small">JSON</button>
<button id="clear" class="small">Καθάρισμα</button>
</div>
</div>
<table id="logTable">
<thead><tr><th>Όνομα</th><th>Ενέργεια</th><th>Ημ/νία</th><th>Ώρα</th><th>Σημειώσεις</th></tr></thead>
<tbody></tbody>
</table>
</div>

<div class="card tab" id="tab-reports">
<div class="row">
<div><label>Μήνας</label><input id="rep-month" type="month"></div>
<div><label>&nbsp;</label><button id="calc-month" class="small">Υπολογισμός</button></div>
</div>
<table id="reportTable">
<thead><tr><th>Εργαζόμενος</th><th>Ημέρα</th><th>Ημ/νία</th><th>Ώρες</th><th>Κατάσταση</th></tr></thead>
<tbody></tbody>
</table>
</div>

<div class="card tab" id="tab-settings">
<label>Λίστα εργαζομένων</label>
<textarea id="names" rows="4" style="width:100%;font-family:inherit" placeholder="Κάθε όνομα σε νέα γραμμή"></textarea>
<div class="row">
<div class="grow">
<label>Webhook URL</label>
<input id="webhook" placeholder="επικόλλησε εδώ το Web App URL">
<div class="hint">Στο OUT στέλνεται payload (start/end/minutes/date).</div>
</div>
<div><label>Ώρα έναρξης</label><input id="shiftStart" placeholder="09:00"></div>
<div><label>Ανοχή καθυστέρησης</label><input id="grace" type="number" min="0" step="1" value="5"></div>
</div>
<div class="row">
<button id="saveSettings">Αποθήκευση</button>
<span class="hint" id="saveMsg"></span>
</div>
</div>
</div>

<footer>PWA offline • Cloud sync στο OUT • PIN-lock</footer>
</div>

<!-- Modal PIN -->
<div id="pinModal">
<div id="pinBox">
<h3 id="pinTitle">Κωδικός διαχειριστή</h3>
<input id="pinInput" type="password" placeholder="PIN" style="width:100%; padding:10px; border:1px solid #d7dbe2; border-radius:10px">
<div style="display:flex; gap:8px; margin-top:12px; justify-content:flex-end">
<button id="pinCancel" class="small">Άκυρο</button>
<button id="pinOk" class="small">OK</button>
</div>
<div id="pinMsg"></div>
</div>
</div>

<script src="sw.js"></script>
</body>
</html>
