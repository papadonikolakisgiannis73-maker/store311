<!doctype html>
<html lang="el">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
<title>Store311 Attendance</title>
<link rel="manifest" href="manifest.json" />
<meta name="theme-color" content="#0f1e36" />
<style>
:root{
--pad:20px; --radius:14px; --shadow:0 6px 18px rgba(0,0,0,.08);
--blue:#2f6fe4; --blue-dark:#1f51af; --green:#1e7b46; --green-bg:#eaf8f0; --ink:#0f172a;
}
*{box-sizing:border-box} body{margin:0;font:16px/1.35 system-ui,-apple-system,Segoe UI,Roboto,sans-serif;color:var(--ink);background:#fff}
.topbar{position:sticky;top:0;z-index:50;display:flex;align-items:center;gap:12px;padding:14px var(--pad);background:#0f1e36;color:#fff}
.brand{display:flex;align-items:center;gap:10px;font-weight:600;font-size:18px}
.brand img{height:26px;width:auto}
.lock-btn{margin-left:auto;display:inline-flex;align-items:center;gap:8px;border:0;border-radius:999px;padding:10px 14px;background:rgba(255,255,255,.12);color:#fff;cursor:pointer}
.lock-btn[aria-pressed="true"]{background:#c026d3}
.wrap{padding:18px var(--pad) 80px}
h1{margin:8px 0 4px;font-size:28px}
.sub{color:#475569;margin:0 0 12px}
.tabs{display:flex;gap:14px;overflow:auto;padding-bottom:10px;border-bottom:1px solid #e5e7eb}
.tab{padding:10px 14px;border-radius:12px;background:#f5f7fb;color:#0f172a;cursor:pointer;white-space:nowrap}
.tab[aria-selected="true"]{background:#dbe7ff}
.tab[disabled]{opacity:.45;cursor:not-allowed}
.card{margin-top:16px;background:#fff;border:1px solid #eef2f7;border-radius:16px;box-shadow:var(--shadow);padding:16px}
label{display:block;margin:10px 0 6px;color:#334155}
.row{display:flex;gap:10px}
.input{flex:1;display:flex;align-items:center;border:1px solid #e5e7eb;border-radius:12px;padding:12px 14px;background:#fff}
select,input[type=text]{width:100%;border:0;outline:0;font-size:16px;background:transparent}
.pill{display:inline-flex;align-items:center;gap:8px;padding:8px 12px;border-radius:999px;background:#f1f5f9;color:#0f172a}
.actions{display:flex;gap:16px;margin-top:12px}
.btn{flex:1;display:flex;align-items:center;justify-content:center;gap:12px;font-weight:700;font-size:20px;border:2px solid transparent;border-radius:20px;padding:22px 16px;cursor:pointer;transition:transform .05s ease}
.btn:active{transform:scale(.99)}
.btn-in{background:var(--green-bg);border-color:#b7e4cb;color:#0b3f26}
.btn-out{background:#2f6fe4;color:#fff}
.btn[disabled]{opacity:.6;cursor:not-allowed}
.btn .spinner{display:none;width:18px;height:18px;border:3px solid rgba(255,255,255,.5);border-top-color:#fff;border-radius:50%;animation:spin .8s linear infinite}
.btn.wait .spinner{display:inline-block}
@keyframes spin{to{transform:rotate(360deg)}}
.last{margin-top:10px;font-size:14px;color:#334155}
.toast{position:fixed;left:50%;bottom:18px;transform:translateX(-50%);z-index:100;background:#0f172a;color:#fff;padding:12px 16px;border-radius:14px;box-shadow:var(--shadow);opacity:0;pointer-events:none;transition:opacity .25s, transform .25s}
.toast.show{opacity:1;transform:translateX(-50%) translateY(-6px)}
.history{font-size:15px;margin-top:8px;color:#475569}
.history ul{margin:8px 0 0;padding-left:16px}
</style>
</head>
<body>
<header class="topbar">
<div class="brand">
<img src="logo.png" alt="Store311" />
<span>Store311</span>
</div>
<button id="lockBtn" class="lock-btn" aria-pressed="false" title="Κλείδωμα">
<span>🔒</span> Κλείδωμα
</button>
</header>

<main class="wrap">
<h1>Store311 Attendance</h1>
<p class="sub">Σύστημα παρουσιών προσωπικού</p>

<nav class="tabs" aria-label="Μενού">
<button class="tab" data-tab="check" aria-selected="true">Χτύπημα</button>
<button id="tabHistory" class="tab" data-tab="history">Ιστορική</button>
<button id="tabReports" class="tab" data-tab="reports">Αναφορές</button>
<button id="tabSettings" class="tab" data-tab="settings">Ρυθμίσεις</button>
</nav>

<section class="card">
<label>Επιλέξτε εργαζόμενο / Προσθήκη</label>
<div class="row">
<div class="input">
<select id="employee">
<option>Giannis</option>
<option>Maria</option>
<option>Nikos</option>
</select>
</div>
<div class="input"><input id="newName" type="text" placeholder="Νέο όνομα" /></div>
</div>
<div style="margin-top:8px">
<button id="addBtn" class="pill">➕ Προσθέσε</button>
</div>
</section>

<section class="card">
<div class="history" id="storageNote">Καταχώριση IN/OUT – αποθήκευση τοπικά (offline) σε cloud</div>
<label style="margin-top:12px">Σημείωση</label>
<!-- (προαιρετικό textarea) -->
<div class="actions">
<button id="btnIn" class="btn btn-in" data-action="IN">
<span class="spinner" aria-hidden="true"></span> ✓ IN – Είσοδος
</button>
<button id="btnOut" class="btn btn-out" data-action="OUT">
<span class="spinner" aria-hidden="true"></span> ⬤ OUT – Αποχώρηση
</button>
</div>
<div class="last" id="lastAction">Τελευταία ενέργεια: —</div>
<div class="history">
<strong>Πρόσφατες κινήσεις</strong>
<ul id="recentList"></ul>
</div>
</section>
</main>

<div id="toast" class="toast" role="status" aria-live="polite"></div>

<script>
// ---- helpers
const $ = s => document.querySelector(s);
const formatTime = (d=new Date()) =>
d.toLocaleString('el-GR', {hour:'2-digit', minute:'2-digit', day:'2-digit', month:'2-digit', year:'numeric'});

// ---- lock behaviour: disables History/Reports/Settings tabs
const lockBtn = $('#lockBtn');
const lockableTabs = ['#tabHistory','#tabReports','#tabSettings'].map(s=>$(s));
function setLocked(isLocked){
lockBtn.setAttribute('aria-pressed', String(isLocked));
lockableTabs.forEach(t=> t.disabled = isLocked);
}
lockBtn.addEventListener('click', () => setLocked(lockBtn.getAttribute('aria-pressed')!=='true'));

// ---- local storage keys
const LS_KEY = 'store311.attendance.events';

// ---- load & render recent
function getEvents(){
try { return JSON.parse(localStorage.getItem(LS_KEY) || '[]'); }
catch { return []; }
}
function saveEvent(ev){
const arr = getEvents();
arr.unshift(ev);
localStorage.setItem(LS_KEY, JSON.stringify(arr.slice(0,50))); // κρατάμε τα 50 πιο πρόσφατα
}
function renderRecent(){
const ul = $('#recentList'); ul.innerHTML='';
getEvents().slice(0,6).forEach(e=>{
const li=document.createElement('li');
li.textContent = `${e.emp}: ${e.action} — ${e.time}`;
ul.appendChild(li);
});
}

// ---- employee add
$('#addBtn').addEventListener('click', ()=>{
const name = $('#newName').value.trim();
if(!name) return;
const opt = document.createElement('option'); opt.textContent=name;
$('#employee').appendChild(opt); $('#employee').value=name; $('#newName').value='';
showToast(`Προστέθηκε εργαζόμενος: ${name}`);
});

// ---- IN/OUT handlers with visual confirmation
function disableDuring(btn, ms){
btn.classList.add('wait'); btn.disabled = true;
setTimeout(()=>{ btn.classList.remove('wait'); btn.disabled=false; }, ms);
}
function flashButton(btn, ok=true){
const orig = btn.style.boxShadow;
btn.style.boxShadow = ok ? '0 0 0 4px rgba(16,185,129,.35)' : '0 0 0 4px rgba(239,68,68,.35)';
setTimeout(()=> btn.style.boxShadow = orig, 350);
}
function showToast(msg){
const toast = $('#toast'); toast.textContent = msg;
toast.classList.add('show'); setTimeout(()=> toast.classList.remove('show'), 2200);
if(navigator.vibrate) navigator.vibrate(20);
}
function setLast(action, emp){
$('#lastAction').textContent = `Τελευταία ενέργεια: ${emp} — ${action} (${formatTime()})`;
}

function handleAction(action){
const emp = $('#employee').value;
const btn = action==='IN' ? $('#btnIn') : $('#btnOut');
disableDuring(btn, 700);
flashButton(btn, true);
const event = { emp, action, time: formatTime(), ts: Date.now() };
saveEvent(event);
renderRecent();
setLast(action, emp);
showToast(`${emp}: ${action} καταχωρήθηκε • ${event.time}`);
}

$('#btnIn').addEventListener('click', ()=> handleAction('IN'));
$('#btnOut').addEventListener('click', ()=> handleAction('OUT'));

// init
setLocked(false);
renderRecent();
</script>
</body>
</html>



